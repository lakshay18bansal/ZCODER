'use strict';
var call = require('core-js-pure/internals/function-call');
var isCallable = require('core-js-pure/internals/is-callable');
var anObject = require('core-js-pure/internals/an-object');
var getIteratorDirect = require('core-js-pure/internals/get-iterator-direct');
var getIteratorMethod = require('core-js-pure/internals/get-iterator-method');
var getMethod = require('core-js-pure/internals/get-method');
var wellKnownSymbol = require('core-js-pure/internals/well-known-symbol');
var AsyncFromSyncIterator = require('core-js-pure/internals/async-from-sync-iterator');

var ASYNC_ITERATOR = wellKnownSymbol('asyncIterator');

module.exports = function (obj) {
  var object = anObject(obj);
  var alreadyAsync = true;
  var method = getMethod(object, ASYNC_ITERATOR);
  var iterator;
  if (!isCallable(method)) {
    method = getIteratorMethod(object);
    alreadyAsync = false;
  }
  if (method !== undefined) {
    iterator = call(method, object);
  } else {
    iterator = object;
    alreadyAsync = true;
  }
  anObject(iterator);
  return getIteratorDirect(alreadyAsync ? iterator : new AsyncFromSyncIterator(getIteratorDirect(iterator)));
};
